# Queue Parameter einstellen{{{
#
# usage: q_conf
#
q_conf() {
#
postconf -c $MAIL_CONFIG | grep '^q' | sed -e 's# = #="#g ; s#\$#\\\$#g ; s#$#"#g' >${gv_WorkDir}/postfix$$
read_file -f ${gv_WorkDir}/postfix$$
rm -rf  ${gv_WorkDir}/postfix$$ &>/dev/null
#
# Funktion conf_queue_menue{{{
QUEUE_TITLE=$(gettext 'Konfiguration::queue/qmail')
conf_queue_menue() {
QUEUE_MENU=(qmgr_clog_warn_time \"\$qmgr_clog_warn_time\"
qmgr_fudge_factor \"\$qmgr_fudge_factor\"
qmgr_message_active_limit \"\$qmgr_message_active_limit\"
qmgr_message_recipient_limit \"\$qmgr_message_recipient_limit\"
qmgr_message_recipient_minimum \"\$qmgr_message_recipient_minimum\"
qmqpd_authorized_clients \"\$qmqpd_authorized_clients\"
qmqpd_error_delay \"\$qmqpd_error_delay\"
qmqpd_timeout \"\$qmqpd_timeout\"
queue_directory \"\$queue_directory\"
queue_file_attribute_count_limit \"\$queue_file_attribute_count_limit\"
queue_minfree \"\$queue_minfree\"
queue_run_delay \"\$queue_run_delay\"
postfix \"reload\"
$gv_Back \"\")
menubox "$QUEUE_TITLE" "$gv_Menupoint" "$QUEUE_MENU"
}
#}}}
#
conf_queue_menue
while [ "$gv_Auswahl" ] ; do
	case "$gv_Auswahl" in
		HELP*)	script_help q_help
			conf_queue_menue
			;;
		qmgr_c*)
			#{{{
			number_input -s "${qmgr_clog_warn_time%?}"
			if [ "$NUMBER" ] ; then
				qmgr_clog_warn_time="$NUMBER"
				postconf -e qmgr_clog_warn_time="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmgr_f*)
			# Prozentsatz an Resourcen den postfix fuer ausgehende mails bekommt{{{
			number_input -i "$qmgr_fudge_factor"
			if [ "$NUMBER" ] ; then
				qmgr_fudge_factor="$NUMBER"
				postconf -e qmgr_fudge_factor="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmgr_message_active_limit)
			# max. Anzahl gleichzeitiger mails in der active Queue{{{
			number_input -i "$qmgr_message_active_limit"
			if [ "$NUMBER" ] ; then
				qmgr_message_active_limit="$NUMBER"
				postconf -e qmgr_message_active_limit="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmgr_message_recipient_limit)
			# max. Groesse der Verwaltungsabelle des qmgr{{{
			number_input -i "$qmgr_message_recipient_limit"
			if [ "$NUMBER" ] ; then
				qmgr_message_recipient_limit="$NUMBER"
				postconf -e qmgr_message_recipient_limit="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmgr_message_recipient_minimum)
			# min. Groesse der Verwaltungsabelle des qmgr{{{
			number_input -i "$qmgr_message_recipient_minimum"
			if [ "$NUMBER" ] ; then
				qmgr_message_recipient_minimum="$NUMBER"
				postconf -e qmgr_message_recipient_minimum="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmqpd_a*)
			# Welche clients duerfen mit dem qmail Protokoll{{{
			# postfix kontakten.
			QMAIL_CLIENTS_MSG=$(gettext 'Geben Sie die Rechner oder IP-Adressen ein, die das Qmail-Protokoll (QMQP) nutzen duerfen.')
			inputbox "$QUEUE_TITLE" "$QMAIL_CLIENTS_MSG" "$qmqpd_authorized_clients"
			if [ "$gv_Auswahl" ] ; then
				# Alle eingebenen IP's ueberpruefen
				ip_analyse $gv_Auswahl
				if [ -n "$gv_Ip_Adr" ] ; then
					qmqpd_authorized_clients="$gv_Ip_Adr"
					postconf -e qmqpd_authorized_clients="$qmqpd_authorized_clients"
				else
					qmqpd_authorized_clients=""
					postconf -e qmqpd_authorized_clients=""
				fi
			else
				qmqpd_authorized_clients=""
				postconf -e qmqpd_authorized_clients=""
			fi
			#}}}
			conf_queue_menue
			;;
		qmqpd_e*)
			# Wartezeit nach einem Fehler in einer QMQP Verbindung{{{
			number_input -s "${qmqpd_error_delay%?}"
			if [ "$NUMBER" ] ; then
				qmqpd_error_delay="$NUMBER"
				postconf -e qmqpd_error_delay="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		queue_d*)
			# Pfad zum Queue Verzeichnis{{{
			dselect "$queue_directory"
			if [ "$VERZ" ] ; then
				dselect_check "$VERZ"
				if [ "$VERZ" ] ; then
					queue_directory="$VERZ"
					postconf -e queue_directory="$VERZ"
				fi
			fi
			#}}}
			conf_queue_menue
			;;
		queue_f*)
			# queue_file_attribute_count_limit{{{
			number_input -i "$queue_file_attribute_count_limit"
			if [ "$NUMBER" ] ; then
				queue_file_attribute_count_limit="$NUMBER"
				postconf -e queue_file_attribute_count_limit="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		queue_m*)
			# min. Platenplatz in Bytes, bevor postfix die Annahme von mails verweigert.{{{
			number_input -b "$queue_minfree"
			if [ "$NUMBER" ] ; then
				queue_minfree="$NUMBER"
				postconf -e queue_minfree="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		queue_ru*)
			# Anzahl der Sek. nach denen postfix die deferred Queue nach{{{
			# zuzustellenden mails durchsucht
			number_input -s "${queue_run_delay%?}"
			if [ "$NUMBER" ] ; then
				queue_run_delay="$NUMBER"
				postconf -e queue_run_delay="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		qmqpd_t*)
			# Timeout beim Aufruf des qmqpd{{{
			number_input -s "${qmqpd_timeout%?}"
			if [ "$NUMBER" ] ; then
				qmqpd_timeout="$NUMBER"
				postconf -e qmqpd_timeout="$NUMBER"
			fi
			#}}}
			conf_queue_menue
			;;
		p*)	postfix_start_reload
			break
			;;
		$gv_Back)	break
			;;
	esac
done
}
#}}}
### Modeline {{{
### vim:ft=zsh:foldmethod=marker
### vim:set ts=4:                                                                               
### }}}
